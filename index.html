<!DOCTYPE html>
<html>

  <head>

    <!-- Load in jsPsych library and plugins -->
    <script src='https://unpkg.com/jspsych@7.3.3'></script>
    <script src="https://unpkg.com/@jspsych/plugin-fullscreen@1.2.1"></script>
    <script src='https://unpkg.com/@jspsych/plugin-html-keyboard-response@1.1.2'></script>
    <script src='https://unpkg.com/@jspsych/plugin-html-button-response@1.1.2'></script>
    <script src='https://unpkg.com/@jspsych/plugin-call-function@1.1.2'></script>
    <script src='https://unpkg.com/@jspsych-contrib/plugin-rok@1.1.1'></script>
    
    <!-- Initialise jsPsych, create general timeline and start full-screen mode -->
    <script> 
    
      var jsPsych = initJsPsych({
        on_finish: function() {
  
          // Remove requirement to verify redirect
          window.removeEventListener('beforeunload', verify_unload);
  
          // Add interactions to the data variable
          var interaction_data = jsPsych.data.getInteractionData();
          jsPsych.data.get().addToLast({interactions: interaction_data.json()});
  
          jsPsych.data.displayData();
          jsPsych.data.get().csv();
        },
        
        /* Set 100 ms as the minimum time between stimulus onset and 
        response to reduce the number of invalid trials. */
        minimum_valid_rt: 100
      });
  
      /* Create empty timeline object, which will be sequentially 
      filled in using language_vision_SemPri_TIMELINE.push() */
      var language_vision_SemPri_TIMELINE = [];
      
      // Full-screen mode
      var enter_fullscreen = {
        type: jsPsychFullscreen,
        fullscreen_mode: true
      }
      // Add to general timeline
      language_vision_SemPri_TIMELINE.push(enter_fullscreen);
      
    </script>
    
    <!-- Function for creating range of numbers -->
    <script>
      function makeArr(startValue, stopValue, cardinality) {
        var arr = [];
        var step = (stopValue - startValue) / (cardinality - 1);
        for(var i = 0; i < cardinality; i++) {
          arr.push(startValue + (step * i));
        }
        return arr;
      }
    </script>
    
    <!-- Initialise trial number -->
    <script> var TrialNum = 0 </script>

    <!-- Assign random ID to participant, and record date and time -->
    <script>
      jsPsych.data.addProperties({
        Participant: jsPsych.randomization.randomID(15),
        experiment_start: new Date().toUTCString()
      });
    </script>
  
    <!-- Prevent backing and refreshing (as in 
    https://github.com/nivlab/jspsych-demos/blob/main/tasks/vocabulary/experiment.html) -->
    <script>
      function verify_unload(e) {
        e.preventDefault();
        (e || window.event).returnValue = null;
        return null;
      };
      window.addEventListener('beforeunload', verify_unload);
    </script>

    <!-- Load in jquery library -->
    <script src='https://ajax.googleapis.com/ajax/libs/jquery/3.7.0/jquery.min.js'></script>

    <!-- Load in CSS -->
    <link rel='stylesheet' href='https://unpkg.com/jspsych@7.3.3/css/jspsych.css' />
    <link rel='stylesheet' href='style.css' />

    <!-- Load in instructional_manipulation_check -->
    <script src='js/breaks.js'></script>

    <!-- Load in instructional_manipulation_check -->
    <script src='js/instructional_manipulation_check.js'></script>

    <!-- Load in reading ability stimuli and task (tag: 'ReadAbil') -->
    <script src='js/reading_ability_stimuli.js'></script>
    <!--<script src='js/reading_ability_task.js'></script>-->

    <!-- Load in semantic priming stimuli and task (tag: 'SemPri') -->
    <script src='js/semanticpriming_practice_stimuli.js'></script>
    <script src='js/semanticpriming_main_stimuli_1.js'></script>
    <script src='js/semanticpriming_main_stimuli_2.js'></script>
    <!--<script src='js/semanticpriming_task.js'></script>-->

    <!-- Load in working memory task (tag: 'WorkMem') -->
    <script src='js/working_memory_task.js'></script>
    
    <!-- Load in visual ability task, which is presented after semantic priming 
    because visually-demanding tasks can increase perceptual simulation in 
    subsequent semantic tasks (Pecher et al., 1998; Yee et al., 2012). -->
    <script src='js/visual_ability_task.js'></script>
  
    <!-- Exit full-screen and end experiment -->
    <script>
    
      var exit_fullscreen = {
        type: jsPsychFullscreen,
        fullscreen_mode: false,
        delay_after: 0
      }
      // Add to general timeline
      language_vision_SemPri_TIMELINE.push(exit_fullscreen);
      
      var end_experiment = {
        type: jsPsychHtmlKeyboardResponse,
        choices: [' '],
        stimulus: function() {
          return '<div>The experiment has finished. <br>Thank you for your contribution!</div>';
        }
      };
      // Add to general timeline
      language_vision_SemPri_TIMELINE.push(end_experiment);
      
    </script>

  </head>


  <!-- Run experiment -->
  <script> jsPsych.run(language_vision_SemPri_TIMELINE); </script>

</html>

